<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 804 572" width="67pc" height="572pt" xmlns:dc="http://purl.org/dc/elements/1.1/"><metadata> Produced by OmniGraffle 6.5 <dc:date>2016-03-17 01:32:20 +0000</dc:date></metadata><defs><filter id="Shadow" filterUnits="userSpaceOnUse"><feGaussianBlur in="SourceAlpha" result="blur" stdDeviation="1.308"/><feOffset in="blur" result="offset" dx="0" dy="2"/><feFlood flood-color="black" flood-opacity=".5" result="flood"/><feComposite in="flood" in2="offset" operator="in"/></filter><font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="532.22656" cap-height="719.72656" ascent="770.01953" descent="-229.98047" font-weight="bold"><font-face-src><font-face-name name="Helvetica-Bold"/></font-face-src></font-face><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="StickArrow_Marker" viewBox="-1 -6 14 12" markerWidth="14" markerHeight="12" color="black"><g><path d="M 11.428568 0 L 0 0 M 0 -4.285713 L 11.428568 0 L 0 4.285713" fill="none" stroke="currentColor" stroke-width="1"/></g></marker><font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-weight="500"><font-face-src><font-face-name name="Helvetica"/></font-face-src></font-face><font-face font-family="Helvetica Neue" font-size="12" panose-1="2 0 5 3 0 0 0 2 0 4" units-per-em="1000" underline-position="-100" underline-thickness="50" slope="0" x-height="517" cap-height="714" ascent="951.99585" descent="-212.99744" font-weight="500"><font-face-src><font-face-name name="HelveticaNeue"/></font-face-src></font-face><font-face font-family="Helvetica Neue" font-size="14" panose-1="2 0 5 3 0 0 0 2 0 4" units-per-em="1000" underline-position="-100" underline-thickness="50" slope="0" x-height="517" cap-height="714" ascent="951.99585" descent="-212.99744" font-weight="500"><font-face-src><font-face-name name="HelveticaNeue"/></font-face-src></font-face><font-face font-family="Heiti SC" font-size="12" units-per-em="1000" underline-position="-133" underline-thickness="20" slope="0" x-height="531" cap-height="718" ascent="860.0006" descent="-139.99939" font-weight="bold"><font-face-src><font-face-name name="STHeitiSC-Medium"/></font-face-src></font-face><font-face font-family="Heiti SC" font-size="12" panose-1="2 0 0 0 0 0 0 0 0 0" units-per-em="1000" underline-position="-133" underline-thickness="20" slope="0" x-height="591" cap-height="778" ascent="860.0006" descent="-139.99939" font-weight="300"><font-face-src><font-face-name name="STHeitiSC-Light"/></font-face-src></font-face></defs><g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"><title>5.activate_snapshot</title><rect fill="white" width="815" height="655"/><g><title>Layer 1</title><g><xl:use xl:href="#id41_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id42_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id44_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id46_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id289_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id292_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id294_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id296_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id298_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id306_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id311_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id316_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id319_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id321_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id330_Graphic" filter="url(#Shadow)"/><xl:use xl:href="#id332_Graphic" filter="url(#Shadow)"/></g><circle cx="45" cy="54" r="9.0000144" fill="white"/><circle cx="45" cy="54" r="9.0000144" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="45" y1="63" x2="45" y2="90" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="45" y1="90" x2="36" y2="117" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="45" y1="90" x2="54" y2="117" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="45" y1="72" x2="27" y2="72" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="63" y1="72" x2="45" y2="72" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(23 118.5)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="2.3242188" y="11" textLength="39.351562">docker</tspan></text><rect x="81" y="54" width="81" height="27" fill="white"/><rect x="81" y="54" width="81" height="27" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(86 60.5)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="9.821289" y="11" textLength="54.691406">libdevice </tspan></text><line x1="121.5" y1="81.5" x2="121.5" y2="225" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><rect x="171" y="45" width="72" height="36" fill="white"/><rect x="171" y="45" width="72" height="36" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(176 49)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="10.981445" y="11" textLength="40.03711">syscall</tspan><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="18.666016" y="25" textLength="28.001953">ioctl </tspan></text><line x1="207" y1="81.5" x2="207" y2="297" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><g id="id41_Graphic"><line x1="54" y1="107.90909" x2="103.671446" y2="107.980767" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(69.778577 83.04729)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="33.351562">create</tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="25" textLength="19.347656">thin</tspan></text><g id="id42_Graphic"><line x1="126" y1="108" x2="193.67143" y2="108" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(141.12558 90.09091)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="53.35547">dm create</tspan></text><g id="id44_Graphic"><line x1="126" y1="207" x2="184.67143" y2="207" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(136.94496 189.09091)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="52.04297">table load</tspan></text><g id="id46_Graphic"><line x1="216" y1="108" x2="265.67143" y2="108" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(221.76434 90.09091)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="53.35547">dm create</tspan></text><text transform="translate(216 138.5)" fill="black"><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="11" textLength="36">dev_cr</tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="35.784" y="11" textLength="23.112">eate</tspan></text><rect x="333" y="54" width="72" height="20.25" fill="white"/><rect x="333" y="54" width="72" height="20.25" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(338 57.125)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="22" y="11" textLength="18">dm</tspan></text><line x1="369" y1="74.75" x2="369" y2="432" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><rect x="252" y="54" width="72" height="20.25" fill="white"/><rect x="252" y="54" width="72" height="20.25" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(257 57.125)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="7.6679688" y="11" textLength="46.664062">dm-ioctl</tspan></text><line x1="288" y1="74.75" x2="288" y2="432" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><g id="id289_Graphic"><rect x="279.5" y="99" width="17" height="90" fill="white"/><rect x="279.5" y="99" width="17" height="90" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><g id="id292_Graphic"><line x1="297" y1="108" x2="355.67272" y2="108.8149" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(306.09646 90.61203)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="56.695312">dm_create</tspan></text><g id="id294_Graphic"><line x1="216" y1="207" x2="265.67143" y2="207" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(222.26434 189.09091)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="52.04297">table load</tspan></text><g id="id296_Graphic"><rect x="280" y="198" width="17" height="90" fill="white"/><rect x="280" y="198" width="17" height="90" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(216 243.5)" fill="black"><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="11" textLength="55.56">table_load</tspan></text><g id="id298_Graphic"><line x1="306" y1="216" x2="427.67143" y2="216" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(345.7093 198.09091)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="6">fi</tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="6" y="11" textLength="54.708984">nd_device</tspan></text><rect x="414" y="36" width="72" height="34.137931" fill="white"/><rect x="414" y="36" width="72" height="34.137931" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(419 39.068966)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="16.996094" y="11" textLength="28.007812">hash</tspan><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="16.328125" y="25" textLength="29.34375">store</tspan></text><line x1="450" y1="70.63793" x2="450" y2="432" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><g id="id306_Graphic"><line x1="297" y1="144" x2="436.67143" y2="144" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(333.57054 126.09091)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="85.38281">dm_hash_insert</tspan></text><rect x="495" y="54" width="72" height="20.25" fill="white"/><rect x="495" y="54" width="72" height="20.25" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(500 57.125)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="5.998047" y="11" textLength="50.003906">dm-table</tspan></text><line x1="531" y1="74.75" x2="531" y2="432" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><g id="id311_Graphic"><line x1="306" y1="242.90909" x2="508.67143" y2="242.90909" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(373.33488 225)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="89.390625">dm_table_create</tspan></text><rect x="576" y="36" width="72" height="34.503695" fill="white"/><rect x="576" y="36" width="72" height="34.503695" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(581 32.251847)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="3.6689453" y="11" textLength="54.66211">taget[dm-</tspan><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="1.6767578" y="25" textLength="58.646484">thin::thin_</tspan><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="12.332031" y="39" textLength="37.335938">target]</tspan></text><line x1="612" y1="71.003695" x2="612" y2="432" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><g id="id316_Graphic"><line x1="306" y1="270" x2="589.67143" y2="270" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(403.46046 252.09091)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="113.41992">dm_table_add_target</tspan></text><text transform="translate(18 297)" fill="black"><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="11" textLength="87.588">dmsetup create </tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="25" textLength="152.028">docker-8:1-1055230-&lt;uuid&gt;</tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="39" textLength="110.244">—addnodeoncreate </tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="53" textLength="117.624">--table &quot;0 314572800 </tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="67" textLength="23.124">thin </tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="81" textLength="210.96">/dev/mapper/docker-8:2-1050856-pool</tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="97" textLength="86.628">&lt;childDeviceId&gt;</tspan><tspan font-family="Helvetica Neue" font-size="14" font-weight="500" x="86.628" y="97" textLength="5.964">”</tspan></text><g id="id319_Graphic"><rect x="603" y="261" width="17" height="144" fill="white"/><rect x="603" y="261" width="17" height="144" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(591.5 306.5)" fill="black"><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="11" textLength="40.008">thin_ctr</tspan></text><g id="id321_Graphic"><line x1="603" y1="288" x2="544.32857" y2="288" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(524.55504 270.09091)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="81.38672">dm_get_device</tspan></text><rect x="657" y="54" width="72" height="20.25" fill="white"/><rect x="657" y="54" width="72" height="20.25" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(662 50.125)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="7.008789" y="11" textLength="47.982422">dm-thin-</tspan><tspan font-family="Helvetica" font-size="12" font-weight="bold" x="4.65625" y="25" textLength="52.6875">metadata</tspan></text><line x1="693" y1="74.75" x2="693" y2="432" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><g id="id330_Graphic"><line x1="603" y1="333" x2="391.32857" y2="333" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(453.9845 315.09091)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="63.36914">dm_get_md</tspan></text><g id="id332_Graphic"><line x1="621" y1="368.9091" x2="679.67143" y2="368.9091" marker-end="url(#StickArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g><text transform="translate(584.94496 351)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="0" y="11" textLength="146.7832">dm_pool_open_thin_device</tspan></text><text transform="translate(9 261.5)" fill="black"><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="11" textLength="172.92">activate the internal snap device</tspan></text><text transform="translate(54 432)" fill="black"><tspan font-family="Heiti SC" font-size="12" font-weight="bold" x="0" y="23" textLength="189.108">dm在这一步会产生/dev/mapper/</tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="189.108" y="23" textLength="155.628">docker-8:1-1055230-#{uuid} </tspan><tspan font-family="Heiti SC" font-size="12" font-weight="300" x="344.736" y="23" textLength="24">这个</tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="368.736" y="23" textLength="42.012">gendisk</tspan><tspan font-family="Heiti SC" font-size="12" font-weight="300" x="410.748" y="23" textLength="24">，该</tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="434.748" y="23" textLength="42.012">gendisk</tspan><tspan font-family="Heiti SC" font-size="12" font-weight="300" x="476.76" y="23" textLength="158.304">表示了pool大磁盘的一个分区</tspan><tspan font-family="Heiti SC" font-size="12" font-weight="300" x="0" y="37" textLength="36">可以被</tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="36" y="37" textLength="66.936">mkfs, mount</tspan><tspan font-family="Heiti SC" font-size="12" font-weight="300" x="102.936" y="37" textLength="72">等。可以往该</tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="174.936" y="37" textLength="42.012">gendisk</tspan><tspan font-family="Heiti SC" font-size="12" font-weight="300" x="216.948" y="37" textLength="72">分区写文件。</tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="0" y="65" textLength="35.112">device</tspan><tspan font-family="Heiti SC" font-size="12" font-weight="300" x="35.112" y="65" textLength="12">是</tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="47.112" y="65" textLength="81">hash=“#{uuid}”</tspan><tspan font-family="Heiti SC" font-size="12" font-weight="300" x="128.112" y="65" textLength="12">的</tspan><tspan font-family="Helvetica Neue" font-size="12" font-weight="500" x="140.112" y="65" textLength="441.396"> base{&quot;device_id”:#{uuid},”size&quot;:85899345920,&quot;transaction_id”:2,”initialized”:false}</tspan></text></g></g></svg>
